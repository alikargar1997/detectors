# -*- coding: utf-8 -*-

import json
import re
import string
import logging
import sys
from collections import OrderedDict
from preprocess.PersianNormalizer import PersianNormalizer


class PolarityDetector(object):

    def __init__(self, logger=logging.basicConfig(format='[%(asctime)s] %(levelname)s %(name)s %(message)s',
                                                  stream=sys.stdout, level=logging.INFO)):
        self.__logger = logger
        self.__Normalizer = PersianNormalizer()
        self.__LoadStopwords()
        self.__LoadWordsDictionary()
        self.__POSETIVE_EMOJI = [':-)', '=)', ':)', '8)', ':]', '=]', '=>', '8-)', ':->', ':-]', ':â€)', ':â€™)', ':-)',
                                 '=)',
                                 ':3',
                                 ':>', ':Ë†)', ':-3', '=>', ':->', ':-V', '=v',
                                 ':-1', 'Ë†', 'Ë†', 'Ë†LË†', 'Ë†)Ë†', ':*', ':-*', ';-)', ';)', ';-]', ';]', ';->', ';>',
                                 '%-}',
                                 '<3',
                                 ':-D', ':D', '=D', ':-P', '=3', 'xD', ':P', '=P',
                                 'O.o', 'o.O', ':v', 'B)', 'B-)', 'B|', '8|', ':â€™-)', ':!', ':-X', '=*', ':-*', ':*',
                                 'ðŸ˜€', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ˜', 'ðŸ˜†', 'ðŸ˜…', 'ðŸ˜', 'ðŸ˜³', 'ðŸ˜Ž', 'ðŸ˜º', 'ðŸ˜¸', 'ðŸ˜¹', 'ðŸ˜»', 'ðŸ˜¼',
                                 'ðŸ’‹',
                                 'ðŸ’ª',
                                 'ðŸ‘€', 'ðŸ‘', 'ðŸ‘…', 'ðŸ‘„', 'ðŸ‘¶', 'ðŸ™‹', 'ðŸ˜¶', 'ðŸ˜', 'ðŸ¤£', 'â¤', 'ðŸ˜‚', 'ðŸ™‚', 'ðŸ™ƒ', 'ðŸ˜‰',
                                 'ðŸ˜Š', 'ðŸ˜‡',
                                 'ðŸ˜', 'ðŸ˜˜', 'ðŸ˜—', 'â˜º', 'ðŸ˜š', 'ðŸ˜™', 'ðŸ˜‹', 'ðŸ˜›', 'ðŸ˜œ', 'ðŸ˜', 'ðŸ™„', 'ðŸ‘', 'ðŸ’™', 'ðŸŽ€', 'ðŸŒ¸'
                                 ]
        self.__NEGATIVE_EMOJI = ['- -', ':-(', ':(', ':[', ':-<', ':-[', '=(', ':-@', ':-&', ':-t', ':-z', ':<)', '}-(',
                                 ':o',
                                 ':O', ':-o', ':-O', ':-\\',
                                 ':-/', ':-.', ':\\', ':â€™(', ':, (', ':â€™-(', ':, -(', ':Ëœ(ËœËœ', ':Ëœ-(',
                                 'ðŸ˜Ÿ', 'ðŸ™', 'ðŸ˜®', 'ðŸ˜¯', 'ðŸ˜²', 'ðŸ˜³', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜®', 'ðŸ˜¨', 'ðŸ˜°', 'ðŸ˜¥', 'ðŸ˜¢', 'ðŸ˜­',
                                 'ðŸ˜±',
                                 'ðŸ˜–', 'ðŸ˜£', 'ðŸ˜ž', 'ðŸ˜“', 'ðŸ˜©', 'ðŸ˜«', 'ðŸ˜¤', 'ðŸ˜¡', 'ðŸ˜ ', 'ðŸ‘¿', 'ðŸ’€', 'â˜ ', 'ðŸ’©', 'ðŸ‘Ž',
                                 'ðŸ˜‘']
        self.__EMOJI = [':-)', '=)', ':)', '8)', ':]', '=]', '=>', '8-)', ':->', ':-]', ':â€)', ':â€™)', '=)', ':3', ':>',
                        ':Ë†)',
                        '=>', ':->', ':-V', '=v', ':-1', 'Ë†', 'Ë†', 'Ë†LË†', 'Ë†)Ë†', ':*', ':-*', ';-)', ';)', ';-]', ';]',
                        ';->',
                        ';>', '%-}', '<3', ':-D', ':D', '=D', ':-P', '=3', 'xD', ':P', '=P', 'O.o', 'o.O', ':v', 'B)',
                        'B-)',
                        'B|', '8|', ':â€™-)', ':!', ':-X', '=*', ':-*', ':*', '- -', ':-(', ':(', ':[', ':-<', ':-[',
                        '=(',
                        ':-@', ':-&', ':-t', ':-z', ':<)', '}-(', ':o', ':O', ':-o', ':-O', ':-\\', ':-/', ':-.', ':\\',
                        ':â€™(',
                        ':, (', ':â€™-(', ':, -(', ':Ëœ(ËœËœ', ':Ëœ-(', 'ðŸŒ´', 'â­•', 'ðŸ˜€', 'ðŸ’', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ¦–', 'ðŸŒŸ', 'ðŸŽ‚',
                        'ðŸ˜',
                        'ðŸŽŠ', 'ðŸ“', 'ðŸ˜†', 'ðŸ˜…', 'ðŸ”ª', ':', 'ðŸ¤£', 'ðŸ˜‚', 'ðŸ™‚', 'â£', 'ðŸ™ƒ', 'â˜˜', 'ðŸ˜‰', 'ðŸ˜Š', 'Ùª', 'ðŸ˜‡',
                        'ðŸ¥°', 'ðŸ˜',
                        'ðŸ¤©', 'ðŸ˜˜', 'ðŸ“˜', 'ðŸ˜—', 'â˜º', 'ðŸ˜š', 'ðŸ˜™', 'ðŸ˜‹', 'ðŸ˜›', 'ðŸ˜œ', 'ðŸ¤ª', 'ðŸ’«', 'ðŸ””', 'âœ…', 'ðŸ˜', 'ðŸ¤‘',
                        'ðŸ¤—',
                        'ðŸ¤­', 'ðŸ¤«', 'ðŸ–¤', 'ðŸ½ï¸', 'ðŸ¼ï¸', 'ðŸ¤”', 'ðŸ¤', 'ðŸ¤¨', 'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜¶', 'ðŸ“¥', 'ðŸ’£', 'ðŸ€', 'ðŸ¦‹',
                        'ðŸ’£', 'ðŸ“Œ',
                        'ðŸ˜', 'ðŸ˜’', 'ðŸ™„', 'ðŸ“†', 'ðŸ˜¬', 'ðŸ¤¥', 'ðŸ˜Œ', 'ðŸ˜”', 'ðŸ˜ª', 'ðŸ¤¤', 'ðŸŒ’', 'ðŸ˜´', 'ðŸ˜·', 'ðŸ¤’', 'ðŸ¤•', 'ðŸ¤¢',
                        'ðŸ¤®',
                        'ðŸ¤§', 'ðŸ¥µ', 'ðŸ¥¶', 'ðŸ¥´', 'ðŸ˜µ', 'ðŸ¤¯', 'ðŸ¤ ', 'ðŸ¦Œ', 'ðŸ¥³', 'ðŸ˜Ž', 'ðŸ¤“', 'ðŸ§', 'ðŸ˜•', 'ðŸ»', 'ðŸš¨', 'ðŸ˜Ÿ',
                        'ðŸ™',
                        'â˜¹', 'ðŸ˜®', 'ðŸ˜¯', 'ðŸ˜²', 'ðŸ˜³', 'ðŸ¥º', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ’ï¸', 'ðŸŒ¶', 'ðŸ¶', 'ðŸ˜¨', 'ðŸ˜°', 'ðŸ˜¥', 'ðŸ˜¢', 'ðŸ˜­',
                        'ðŸ˜±',
                        'ðŸ˜–', 'ðŸ˜£', 'ðŸ˜ž', 'ðŸ˜“', 'ðŸ˜©', 'ðŸ˜«', 'ðŸ’•', 'ðŸ˜¤', 'ðŸ˜¡', 'ðŸ˜ ', 'ðŸ¤¬', 'ðŸ´', 'ðŸŽ¥', 'ðŸ˜ˆ', 'ðŸ‘¿', 'ðŸ”¸',
                        'ðŸŒ¸',
                        'ðŸ’€', 'â˜ ', 'ðŸ’©', 'ðŸ¤¡', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ‘»', 'ðŸ‘½', 'ðŸ‘¾', 'â˜”', 'ðŸ¤–', 'ðŸ˜º', 'ðŸ˜¸', 'ðŸ˜¹', 'ðŸ˜»', 'ðŸ˜¼',
                        'ðŸ˜½',
                        'ðŸ™€', 'ðŸ˜¿', 'ðŸ˜¾', 'ðŸ’‹', 'ðŸ‘‹', 'ðŸ¤š', 'ðŸ–', 'ðŸ’”', 'âœ‹', 'ðŸ™ˆ', 'ðŸ’š', 'ðŸ––', 'ðŸ‘Œ', 'âœŒ', 'ðŸ¤ž', 'ðŸ¤Ÿ',
                        'ðŸ¤˜',
                        'ðŸ”¥', 'ðŸ¤™', 'ðŸ‘ˆ', 'ðŸ‘‰', 'ðŸ‘†', 'ðŸ–•', 'ðŸ‘‡', 'â˜', 'ðŸ‘', 'ðŸ‘Ž', 'ðŸ’œ', 'âœŠ', 'ðŸ‘Š', 'ðŸ¤›', 'ðŸ¤œ', 'ðŸ‘',
                        'ðŸ™Œ',
                        'ðŸ‘', 'ðŸ¤²', 'ðŸ¤', 'ðŸ™', 'âœ', 'ðŸ’…', 'ðŸ¤³', 'ðŸ”°', 'ðŸ’ª', 'ðŸ¦µ', 'ðŸ¦¶', 'ðŸ’¥', 'ðŸ‘‚', 'ðŸ‘ƒ', 'ðŸ§ ', 'ðŸ‚',
                        'ðŸ¥',
                        'ðŸŒ¸', 'ðŸŒº', 'ðŸ¾', 'âœ¨', 'ðŸ¦·', 'ðŸ¦´', 'ðŸ‘€', 'ðŸ‘', 'ðŸ‘…', 'ðŸ‘„', 'ðŸ‘¶', 'ðŸ§’', 'ðŸ‘¦', 'ðŸ‘§', 'ðŸ§‘', 'ðŸ‘±',
                        'ðŸ‘¨',
                        'ðŸ§”', 'ðŸ‘±', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘±', 'ðŸ‘©', 'ðŸ‘©', 'ðŸ‘©', 'ðŸ‘©', 'ðŸ§“', 'â™¦', 'ðŸ‘´', 'ðŸ‘µ',
                        'ðŸ™',
                        'ðŸ™', 'ðŸ™', 'ðŸ™Ž', 'ðŸ™Ž', 'ðŸ™Ž', 'ðŸ™…', 'ðŸ™…', 'ðŸ™…', 'ðŸ™†', 'ðŸ™†', 'ðŸ™†', 'ðŸ’', 'ðŸ’', 'ðŸ’', 'ðŸ™‹', 'ðŸ™‹',
                        'ðŸ™‹',
                        'ðŸ™‡', 'ðŸ™‡', 'ðŸ™‡', 'ðŸ¤¦', 'ðŸ¤¦', 'ðŸ¤¦', 'ðŸ¤·', 'ðŸ¤·', 'ðŸ¤·', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨',
                        'ðŸ‘©',
                        'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ“²', 'ðŸ‘¨',
                        'ðŸ‘©',
                        'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘®', 'ðŸ‘®', 'ðŸ‘®', 'ðŸ†', 'ðŸ•µ', 'ðŸ•µ', 'ðŸ•µ', 'ðŸ’‚',
                        'ðŸ’‚',
                        'ðŸ’‚', 'ðŸ‘·', 'ðŸ‘·', 'ðŸ‘·', 'ðŸ¤´', 'ðŸ‘¸', 'ðŸ‘³', 'ðŸ‘³', 'ðŸ‘³', 'ðŸ‘²', 'ðŸ§•', 'ðŸ¤µ', 'ðŸ‘°', 'ðŸ¤°', 'ðŸŒ¹', 'â¬‡',
                        'â™‚',
                        'â¤', 'ðŸ¤±', 'ðŸ‘¼', 'ðŸŽ…', 'ðŸ¤¶', 'ðŸ’™', 'ðŸ', 'ðŸ¦¸', 'ðŸ¦¸', 'ðŸ¦¹', 'ðŸ¦¹', 'âœ', 'â™€', 'ðŸ¦¹', 'ðŸ§™', 'ðŸ§™',
                        'ðŸ§™',
                        'ðŸ§š', 'ðŸ§š', 'ðŸ§š', 'ðŸ§›', 'ðŸ§›', 'âž¿', 'ðŸ§›', 'ðŸ§œ', 'ðŸ§œ', 'ðŸ§œ', 'ðŸ§', 'ðŸ§', 'ðŸ§', 'ðŸ§ž', 'ðŸ§ž', 'ðŸ§ž',
                        'ðŸ§Ÿ',
                        'ðŸ§Ÿ', 'ðŸ”´', 'ðŸ’†', 'ðŸ’†', 'ðŸ’†', 'ðŸ’‡', 'ðŸ’‡', 'ðŸ’‡', 'ðŸš¶', 'ðŸš¶', 'ðŸš¶', 'ðŸƒ', 'ðŸƒ', 'ðŸƒ', 'ðŸ’ƒ', 'ðŸ•º',
                        'ðŸ•´',
                        'ðŸ‘¯', 'ðŸ‘¯', 'ðŸ‘¯', 'ðŸ’¢', 'ðŸ»', 'ðŸ§–', 'ðŸ§–', 'ðŸ§˜', 'ðŸ‘­', 'ðŸ‘«', 'ðŸ‘¬', 'ðŸ’', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ’‘', 'ðŸ‘¨',
                        'ðŸ‘©',
                        'ðŸ‘ª', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ’™', 'ðŸ’›', 'ðŸ”µ', 'âš«', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘©',
                        'ðŸ‘©',
                        'ðŸ‘©', 'ðŸ‘©', 'ðŸ‘©', 'ðŸ”º', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ‘©', 'ðŸ‘©', 'ðŸ‘©', 'ðŸ‘©', 'ðŸ—£', 'ðŸ‘¤',
                        'ðŸ‘¥',
                        'ðŸ‘£', 'ðŸ§³', 'ðŸŒ‚', 'â˜‚', 'ðŸ§µ', 'ðŸ§¶', 'ðŸ‘“', 'ðŸ•¶', 'ðŸ¥½', 'ðŸ¥¼', 'ðŸ‘”', 'ðŸ‘•', 'ðŸ‘–', 'ðŸ§£', 'ðŸ§¤', 'ðŸ§¥',
                        'ðŸ§¦',
                        'ðŸ‘—', 'ðŸ‘˜', 'ðŸ‘™', 'ðŸ‘š', 'ðŸ‘›', 'ðŸ‘œ', 'ðŸ‘', 'ðŸŽ’', 'ðŸ‘ž', 'ðŸ‘Ÿ', 'ðŸ¥¾', 'ðŸ¥¿', 'ðŸ‘ ', 'ðŸ‘¡', 'ðŸ‘¢', 'ðŸ‘‘',
                        'ðŸ‘’',
                        'ðŸŽ©', 'ðŸŽ“', 'ðŸ§¢', 'â›‘', 'ðŸ’„', 'ðŸ’', 'ðŸ’¼', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', 'Û±',
                        'Û²',
                        'Û³', 'Û´', 'Ûµ', 'Û¶', 'Û·', 'Û¸', 'Û¹', 'Û°', '!', '@', '#', '$', '%', '^', '&', '*', '(', ')', ')',
                        '_',
                        '+', '=', '-', '|', '|', '}', '{', '[', ']', ':', ':', ',', '.', '<', '/', '?', 'ØŸ', '>', 'Ù‹',
                        'ÙŒ',
                        'ØŒ']
        self.__AlphabetList = "Ø§Ø¨Ù¾ØªØªØ«Ø¬Ú†Ø­Ø®Ø¯Ø°Ø±Ø²Ø³Ø´ØµØ¶Ø·Ø¸Ø¹ØºÙÙ‚Ú©Ú¯Ù„Ù…Ù†ÙˆÙ‡ÛŒØ¢Ø¢Ø¦Ø£Ø¤Ú˜ÙŠÙ¾Û€Û€Ø©Ø¤ÙŠØ¤Ø¥Ø£Ø¡:-) =) :) 8) :] =] => 8-) :-> :-] :â€) :â€™) =) :3 :> :Ë†) => :-> :-V =v :-1 Ë† Ë† Ë†LË† Ë†)Ë† :* :-* ;-) ;) ;-] ;] ;-> ;> %-} <3 :-D :D =D :-P =3 xD :P =P O.o o.O :v B) B-) B| 8| :â€™-) :! :-X =* :-* :*- - :-( :( :[ :-< :-[ =( :-@ :-& :-t :-z :<) }-( :o :O :-o :-O :-\\:-/ :-. :\\ :â€™( :, ( :â€™-( :, -( :Ëœ(ËœËœ :Ëœ-(ðŸŒ´â­•ðŸ˜€ðŸ’ðŸ˜ƒðŸ˜„ðŸ¦–ðŸŒŸðŸŽ‚ðŸ˜ðŸŽŠðŸ“ðŸ˜†ðŸ˜…ðŸ”ª:ðŸ¤£ðŸ˜‚ðŸ™‚â£ðŸ™ƒâ˜˜ðŸ˜‰ðŸ˜ŠÙªðŸ˜‡ðŸ¥°ðŸ˜ðŸ¤©ðŸ˜˜ðŸ“˜ðŸ˜—â˜ºðŸ˜šðŸ˜™ðŸ˜‹ðŸ˜›ðŸ˜œðŸ¤ªðŸ’«ðŸ””âœ…ðŸ˜ðŸ¤‘ðŸ¤—ðŸ¤­ðŸ¤«ðŸ–¤ðŸ½ï¸ðŸ¼ï¸ðŸ¤”ðŸ¤ðŸ¤¨ðŸ˜ðŸ˜‘ðŸ˜¶ðŸ“¥ðŸ’£ðŸ€ðŸ¦‹ðŸ’£ðŸ“ŒðŸ˜ðŸ˜’ðŸ™„ðŸ“†ðŸ˜¬ðŸ¤¥ðŸ˜ŒðŸ˜”ðŸ˜ªðŸ¤¤ðŸŒ’ðŸ˜´ðŸ˜·ðŸ¤’ðŸ¤•ðŸ¤¢ðŸ¤®ðŸ¤§ðŸ¥µðŸ¥¶ðŸ¥´ðŸ˜µðŸ¤¯ðŸ¤ ðŸ¦ŒðŸ¥³ðŸ˜ŽðŸ¤“ðŸ§ðŸ˜•ðŸ»ðŸš¨ðŸ˜ŸðŸ™â˜¹ðŸ˜®ðŸ˜¯ðŸ˜²ðŸ˜³ðŸ¥ºðŸ˜¦ðŸ˜§ðŸ’ï¸ðŸŒ¶ðŸ¶ðŸ˜¨ðŸ˜°ðŸ˜¥ðŸ˜¢ðŸ˜­ðŸ˜±ðŸ˜–ðŸ˜£ðŸ˜žðŸ˜“ðŸ˜©ðŸ˜«ðŸ’•ðŸ˜¤ðŸ˜¡ðŸ˜ ðŸ¤¬ðŸ´ðŸŽ¥ðŸ˜ˆðŸ‘¿ðŸ”¸ðŸŒ¸ðŸ’€â˜ ðŸ’©ðŸ¤¡ðŸ‘¹ðŸ‘ºðŸ‘»ðŸ‘½ðŸ‘¾â˜”ðŸ¤–ðŸ˜ºðŸ˜¸ðŸ˜¹ðŸ˜»ðŸ˜¼ðŸ˜½ðŸ™€ðŸ˜¿ðŸ˜¾ðŸ’‹ðŸ‘‹ðŸ¤šðŸ–ðŸ’”âœ‹ðŸ™ˆðŸ’šðŸ––ðŸ‘ŒâœŒðŸ¤žðŸ¤ŸðŸ¤˜ðŸ”¥ðŸ¤™ðŸ‘ˆðŸ‘‰ðŸ‘†ðŸ–•ðŸ‘‡â˜ðŸ‘ðŸ‘ŽðŸ’œâœŠðŸ‘ŠðŸ¤›ðŸ¤œðŸ‘ðŸ™ŒðŸ‘ðŸ¤²ðŸ¤ðŸ™âœðŸ’…ðŸ¤³ðŸ”°ðŸ’ªðŸ¦µðŸ¦¶ðŸ’¥ðŸ‘‚ðŸ‘ƒðŸ§ ðŸ‚ðŸ¥ðŸŒ¸ðŸŒºðŸ¾âœ¨ðŸ¦·ðŸ¦´ðŸ‘€ðŸ‘ðŸ‘…ðŸ‘„ðŸ‘¶ðŸ§’ðŸ‘¦ðŸ‘§ðŸ§‘ðŸ‘±ðŸ‘¨ðŸ§”ðŸ‘±ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘©ðŸ‘±ðŸ‘©ðŸ‘©ðŸ‘©ðŸ‘©ðŸ§“â™¦ðŸ‘´ðŸ‘µðŸ™ðŸ™ðŸ™ðŸ™ŽðŸ™ŽðŸ™ŽðŸ™…ðŸ™…ðŸ™…ðŸ™†ðŸ™†ðŸ™†ðŸ’ðŸ’ðŸ’ðŸ™‹ðŸ™‹ðŸ™‹ðŸ™‡ðŸ™‡ðŸ™‡ðŸ¤¦ðŸ¤¦ðŸ¤¦ðŸ¤·ðŸ¤·ðŸ¤·ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ“²ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘¨ðŸ‘©ðŸ‘®ðŸ‘®ðŸ‘®ðŸ†ðŸ•µðŸ•µðŸ•µðŸ’‚ðŸ’‚ðŸ’‚ðŸ‘·ðŸ‘·ðŸ‘·ðŸ¤´ðŸ‘¸ðŸ‘³ðŸ‘³ðŸ‘³ðŸ‘²ðŸ§•ðŸ¤µðŸ‘°ðŸ¤°ðŸŒ¹â¬‡â™‚â¤ðŸ¤±ðŸ‘¼ðŸŽ…ðŸ¤¶ðŸ’™ðŸðŸ¦¸ðŸ¦¸ðŸ¦¹ðŸ¦¹âœâ™€ðŸ¦¹ðŸ§™ðŸ§™ðŸ§™ðŸ§šðŸ§šðŸ§šðŸ§›ðŸ§›âž¿ðŸ§›ðŸ§œðŸ§œðŸ§œðŸ§ðŸ§ðŸ§ðŸ§žðŸ§žðŸ§žðŸ§ŸðŸ§ŸðŸ”´ðŸ’†ðŸ’†ðŸ’†ðŸ’‡ðŸ’‡ðŸ’‡ðŸš¶ðŸš¶ðŸš¶ðŸƒðŸƒðŸƒðŸ’ƒðŸ•ºðŸ•´ðŸ‘¯ðŸ‘¯ðŸ‘¯ðŸ’¢ðŸ»ðŸ§–ðŸ§–ðŸ§˜ðŸ‘­ðŸ‘«ðŸ‘¬ðŸ’ðŸ‘¨ðŸ‘©ðŸ’‘ðŸ‘¨ðŸ‘©ðŸ‘ªðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ’™ðŸ’›ðŸ”µâš«ðŸ‘¨ðŸ‘¨ðŸ‘©ðŸ‘©ðŸ‘©ðŸ‘©ðŸ‘©ðŸ”ºðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘¨ðŸ‘©ðŸ‘©ðŸ‘©ðŸ‘©ðŸ‘©ðŸ—£ðŸ‘¤ðŸ‘¥ðŸ‘£ðŸ§³ðŸŒ‚â˜‚ðŸ§µðŸ§¶ðŸ‘“ðŸ•¶ðŸ¥½ðŸ¥¼ðŸ‘”ðŸ‘•ðŸ‘–ðŸ§£ðŸ§¤ðŸ§¥ðŸ§¦ðŸ‘—ðŸ‘˜ðŸ‘™ðŸ‘šðŸ‘›ðŸ‘œðŸ‘ðŸŽ’ðŸ‘žðŸ‘ŸðŸ¥¾ðŸ¥¿ðŸ‘ ðŸ‘¡ðŸ‘¢ðŸ‘‘ðŸ‘’ðŸŽ©ðŸŽ“ðŸ§¢â›‘ðŸ’„ðŸ’ðŸ’¼1234567890Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹Û°!@#$%^&*())_+=-||}{[]::.</?ØŸ>Ù‹ÙŒØŒ"

    def __LoadStopwords(self):
        try:
            with open("preprocess/resources/polarity_stopword.txt", 'r', encoding='utf-8') as file_reader:
                Stopwords = file_reader.readlines()
                self.__StopWords = list()
            for word in Stopwords:
                word = word.strip()
                self.__StopWords.append(word)
        except Exception as e:
            self.__logger.error("Polarity StopWords Loading error, EX: " + str(e))

    def __LoadWordsDictionary(self):
        self.__WordsDict = dict()
        try:
            with open('preprocess/resources/polarity_dict.json', encoding='utf-8') as json_file:
                self.__WordsDict = json.load(json_file)
        except Exception as e:
            self.__logger.error("Polarity Words Dictionary Loading error, EX: " + str(e))

    def __persian_word_extractor(self, text):
        WORD = re.compile(r'\w+')
        ESentance = list()
        for word in WORD.findall(text):
            ExWord = ''
            EWord = list()
            Word = list(word)
            for Char in Word:
                if Char in self.__AlphabetList:
                    ExWord = ExWord + Char
                else:
                    if ExWord != '':
                        EWord.append(ExWord)
                    ExWord = ''
            if ExWord != '':
                EWord.append(ExWord)
            ESentance.extend(EWord)
        ESentance = [x + ' ' for x in ESentance]
        ESentance = ''.join(ESentance)
        return ESentance

    def Detect(self, text):
        polarity_lable = 'z'
        sent_score = 0
        word_count = 1
        try:
            sen = self.__Normalizer.clean_sentence(text)
            Normsen = self.__persian_word_extractor(sen)
            posetiveEmoji = [value for value in self.__POSETIVE_EMOJI if value in sen]
            posetive_count = len(posetiveEmoji)
            negativemoji = [value for value in self.__NEGATIVE_EMOJI if value in sen]
            negative_count = len(negativemoji)
            if (posetive_count > negative_count):
                sent_score = 1
            elif (posetive_count < negative_count):
                sent_score = -1
            else:
                Words = re.sub('[' + string.punctuation + ']', ' ', Normsen).split()
                CListWord = list()
                for word in Words:
                    word = "".join(OrderedDict.fromkeys(word))
                    for emoji in self.__EMOJI:
                        if emoji in word:
                            word = word.replace(emoji, '')
                            CListWord.append(emoji)
                    CListWord.append(word)
                Words = filter(lambda a: a != '', CListWord)
                for word in Words:
                    if word in self.__WordsDict and word not in self.__StopWords and not word.__contains__("http"):
                        if self.__WordsDict[word][0] > 0 or self.__WordsDict[word][1] > 0:
                            word_count = word_count + 1
                            word_sum = self.__WordsDict[word][0] + self.__WordsDict[word][1]
                            word_score = (self.__WordsDict[word][0] * 0.22 - self.__WordsDict[word][
                                1] * 0.78) / word_sum
                            sent_score = sent_score + word_score
                try:
                    sent_score = sent_score / word_count
                except:
                    sent_score = 0
            if sent_score == 0:
                polarity_lable = 'z'
            if sent_score > 0.11:
                polarity_lable = 'p'
            elif sent_score < 0.086:
                polarity_lable = 'n'
        except Exception as err:
            self.__logger.error("Polarity Detector Exception")
            self.__logger.error("Casuse: %s" % err)
        return {'lable': polarity_lable, 'score': sent_score}


if __name__ == '__main__':
    texts = ['Ú†Ù‡ Ø­Ø³ Ù‚Ø´Ù†Ú¯ÛŒ Ùˆ Ø²ÛŒØ¨Ø§ÛŒÛŒ Ø¯Ø§Ø±Ù… Ø§Ù…Ø±ÙˆØ²', 'Ø¨ÛŒØ®ÛŒØ§Ù„ Ø±ÙÛŒÙ‚', 'Ú©Ø§Ø± Ø¨Ø³ÛŒØ§Ø± Ø®ÙˆØ¨ÛŒÛŒÙ‡',
             'Ø³Ù„Ø§Ù… Ù…Ù† Ø§Ù…Ø±ÙˆØ² Ø­Ø§Ù„Ù… Ø®ÛŒÙ„ÛŒ Ø¨Ø¯Ù‡ Ùˆ Ø¯Ø§ØºÙˆÙ†Ù…']
    pl = PolarityDetector()
    for txt in texts:
        resp = pl.Detect(txt)
        print('Text: {}\n{}\n===========================================\n'.format(txt, resp))
