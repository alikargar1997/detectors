<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>Detector.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>Detector.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">gender_guesser.detector</span> <span class="k">as</span> <span class="nn">gender</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">imageProcessor</span> <span class="kn">import</span> <span class="n">ImageAnalyzer</span>
<span class="kn">from</span> <span class="nn">emoji_extractor.extract</span> <span class="kn">import</span> <span class="n">Extractor</span>
<span class="kn">from</span> <span class="nn">langdetect</span> <span class="kn">import</span> <span class="n">detect</span>
<span class="kn">import</span> <span class="nn">jdatetime</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">ast</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>Abstract class for detector classes</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">Detector</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Raises:
    AssertionError &ndash; developer has to override this method</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">detect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">assert</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;override this method&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Detect gender of Instagram users.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">GenderFinder</span><span class="p">(</span><span class="n">Detector</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>class initialization to predefine args and attributes.</p>
<p>Keyword Args:
    **kwargs: this must contain a dict in format and vars: user_data = {&lsquo;fullname&rsquo;:fullname ,
                    &lsquo;username&rsquo;:username ,
                    &lsquo;user_bio&rsquo;:user_bio ,
                    &lsquo;image&rsquo;: profile_pic_url,
                    &lsquo;posts&rsquo;: list of caption of the posts : [&lsquo;str&rsquo;,&rsquo;str&rsquo;,&hellip;]
                 }</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">female_words</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;Ø¯Ø®ØªØ±&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø¯Ø®ØªØ±Ø§Ù†&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø²Ù†&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø²Ù†Ø§Ù†&#39;</span><span class="p">,</span> <span class="s1">&#39;Ù…Ù„Ú©Ù‡&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø®Ø§Ù†ÙˆÙ…&#39;</span><span class="p">,</span> <span class="s1">&#39;girl&#39;</span><span class="p">,</span> <span class="s1">&#39;girls&#39;</span><span class="p">,</span> <span class="s1">&#39;women&#39;</span><span class="p">,</span> <span class="s1">&#39;queen&#39;</span><span class="p">,</span> <span class="s1">&#39;dokhtar&#39;</span><span class="p">,</span> <span class="s1">&#39;zan&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Ø¨Ø§Ù†Ùˆ&#39;</span><span class="p">,</span>
            <span class="s1">&#39;banoo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø¨Ø§Ù†ÙˆØ§Ù†&#39;</span><span class="p">,</span> <span class="s1">&#39;khanoom&#39;</span><span class="p">,</span> <span class="s1">&#39;dokhtaran&#39;</span><span class="p">,</span> <span class="s1">&#39;zan&#39;</span><span class="p">,</span> <span class="s1">&#39;zanan&#39;</span><span class="p">,</span> <span class="s1">&#39;malake&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">male_words</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;Ù…Ø±Ø¯&#39;</span><span class="p">,</span> <span class="s1">&#39;Ù¾Ø³Ø±&#39;</span><span class="p">,</span> <span class="s1">&#39;Ù¾Ø³Ø±Ø§Ù†&#39;</span><span class="p">,</span> <span class="s1">&#39;Ù…Ø±Ø¯Ø§Ù†&#39;</span><span class="p">,</span> <span class="s1">&#39;Ù¾Ø§Ø¯Ø´Ø§Ù‡&#39;</span><span class="p">,</span> <span class="s1">&#39;king&#39;</span><span class="p">,</span> <span class="s1">&#39;boys&#39;</span><span class="p">,</span> <span class="s1">&#39;man&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø¢Ù‚Ø§&#39;</span><span class="p">,</span> <span class="s1">&#39;agha&#39;</span><span class="p">,</span> <span class="s1">&#39;mard&#39;</span><span class="p">,</span> <span class="s1">&#39;padeshah&#39;</span><span class="p">,</span> <span class="s1">&#39;shah&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pesar&#39;</span><span class="p">,</span> <span class="s1">&#39;pesaran&#39;</span><span class="p">,</span> <span class="s1">&#39;mardan&#39;</span><span class="p">,</span> <span class="s1">&#39;aqa&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gender_detector</span> <span class="o">=</span> <span class="n">gender</span><span class="o">.</span><span class="n">Detector</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">=</span> <span class="s2">&quot;https://genderapi.io/api/?name=</span><span class="si">{0}</span><span class="s2">&amp;key=</span><span class="si">{1}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;5ee72d41756fae68974f3bc2&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">female_emoji</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span>
            <span class="s2">&quot;ğŸ˜˜&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ™…&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ™†&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ™‹&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ™&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ™&quot;</span><span class="p">,</span> <span class="s2">&quot;â˜”&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ“&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘„&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘—&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘™&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘š&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘›&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘ &quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘¡&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘¢&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ğŸ‘§&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘©&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘©&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘¯&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘°&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘µ&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘¸&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’ƒ&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’„&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’…&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’†&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’‡&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’‹&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’–&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’•&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ˜Š&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ğŸŒ·ğŸŒ·&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸŒ¸&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸŒ¹&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸŒº&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸŒ»&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸŒ¼&quot;</span><span class="p">,</span> <span class="s2">&quot;â¤&quot;</span><span class="p">,</span> <span class="s2">&quot;â™¥&quot;</span>
        <span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">male_emoji</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span>
            <span class="s2">&quot;ğŸ˜¤&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ™‡&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸš¶&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ…&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸƒ&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘•&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘¦&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘¨&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘®&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘±&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘²&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘³&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘´&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘·&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘º&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘¿&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’‚&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ”ª&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ğŸ”§&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ”«&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘‘&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ‘”&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ”¥&quot;</span><span class="p">,</span> <span class="s2">&quot;ğŸ’£&quot;</span>
        <span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;find_by_fullname&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;find_by_username&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">85</span><span class="p">,</span> <span class="s1">&#39;find_by_text&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span>
                                   <span class="s1">&#39;find_by_image&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;find_by_emoji&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">07</span><span class="p">,</span> <span class="s1">&#39;posts_text&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">40</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genders_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;female&quot;</span><span class="p">:</span> <span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;male&quot;</span><span class="p">:</span> <span class="o">.</span><span class="mi">0</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;user_data&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">randomString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringLength</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">letters</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">stringLength</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Find a single word or a string composed of multiple single words in a given string.</p>
<p>Args:
    w (str): word to find in string.</p>
<p>Returns:
    func: a function object with a string argument.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">findWholeWord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b(</span><span class="si">{0}</span><span class="s1">)\b&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span><span class="o">.</span><span class="n">search</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>Search in pre processed files and detect gender by fullname of the user.</p>
<p>Args:
    full_name (str): user&rsquo;s fullname</p>
<p>Returns:
    [str] : &lsquo;male&rsquo; , &lsquo;female&rsquo; or &lsquo;unknown&rsquo; detected by function</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_fullname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">full_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">splited_name</span> <span class="o">=</span> <span class="n">full_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">first_name</span> <span class="o">=</span> <span class="n">splited_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>last_name = splited_name[1].capitalize()</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">gender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gender_detector</span><span class="o">.</span><span class="n">get_gender</span><span class="p">(</span><span class="n">first_name</span><span class="p">)</span>
            <span class="n">fem_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">mal_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">gender</span> <span class="ow">is</span> <span class="s1">&#39;unknown&#39;</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preprocess/female_persian_names&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">findWholeWord</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">full_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                            <span class="n">fem_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preprocess/female_finglish_names&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">findWholeWord</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">full_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                            <span class="n">fem_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preprocess/male_persian_names&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">findWholeWord</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">full_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                            <span class="n">mal_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preprocess/male_finglish_names&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">findWholeWord</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">full_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                            <span class="n">mal_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fem_list</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">mal_list</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;male&quot;</span> <span class="k">if</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fem_list</span><span class="p">)</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mal_list</span><span class="p">)</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;female&#39;</span>
        <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_name_api</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">splited_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">first_name</span> <span class="o">=</span> <span class="n">splited_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">first_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">))</span><span class="o">.</span><span class="n">text</span><span class="p">)[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Normalize username by removing numbers and repetitive characters from start and end of username.</p>
<p>Args:
    username (str): username of user</p>
<p>Returns:
    [str]: cleaned username</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">clean_username</span><span class="p">(</span><span class="n">username</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">or</span> <span class="n">username</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">username</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">username</span> <span class="o">=</span> <span class="n">username</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">or</span> <span class="n">username</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">username</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">username</span> <span class="o">=</span> <span class="n">username</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">username</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">username</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> \
                        <span class="ow">not</span> <span class="n">username</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">username</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">username</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">username</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="k">break</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">username</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Compare start and end of username with pre processed names to detect gender.</p>
<p>Args:
    cleaned_username (str): normalized username</p>
<p>Returns:
    [str]: &lsquo;male&rsquo;,&rsquo;female&rsquo; or None</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">name_extractor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cleaned_username</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fem_name</span><span class="p">,</span> <span class="n">mal_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(),</span> <span class="nb">str</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preprocess/female_finglish_names&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">cleaned_username</span> <span class="ow">and</span> <span class="n">cleaned_username</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                    <span class="n">fem_name</span> <span class="o">=</span> <span class="n">name</span>
                <span class="k">elif</span> <span class="n">cleaned_username</span> <span class="ow">and</span> <span class="n">cleaned_username</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                    <span class="n">fem_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preprocess/male_finglish_names&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">cleaned_username</span> <span class="ow">and</span> <span class="n">cleaned_username</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                    <span class="n">mal_name</span> <span class="o">=</span> <span class="n">name</span>
                <span class="k">elif</span> <span class="n">cleaned_username</span> <span class="ow">and</span> <span class="n">cleaned_username</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                    <span class="n">mal_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fem_name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mal_name</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="s2">&quot;female&quot;</span> <span class="k">if</span> <span class="n">fem_name</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;male&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Detect gender by username.</p>
<p>Args:
    username (str): user&rsquo;s username</p>
<p>Returns:
    [str]: result of name_extractor function.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_username</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">cleaned_username</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean_username</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cleaned_username</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_extractor</span><span class="p">(</span><span class="n">cleaned_username</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">gen</span><span class="p">:</span>
            <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[^a-zA-Z]&#39;</span><span class="p">)</span>
            <span class="n">username_list</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">cleaned_username</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">username_list</span><span class="p">:</span>
                <span class="n">gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_extractor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clean_username</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">gen</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">gen</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">gen</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_username_old</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[^a-zA-Z]&#39;</span><span class="p">)</span>
        <span class="n">cleaned_username</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
        <span class="n">fem_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mal_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preprocess/female_finglish_names&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">cleaned_username</span><span class="p">:</span>
                    <span class="n">fem_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preprocess/male_finglish_names&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">cleaned_username</span><span class="p">:</span>
                    <span class="n">mal_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

                    <span class="k">return</span> <span class="s1">&#39;male&#39;</span>
        <span class="k">if</span> <span class="n">fem_list</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">mal_list</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;male&quot;</span> <span class="k">if</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fem_list</span><span class="p">)</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mal_list</span><span class="p">)</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;female&#39;</span>
        <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Search in text for initialized lists of the words depended to males and females genders</p>
<p>Args:
    text (str): biography, caption of posts , etc.</p>
<p>Returns:
    [str]: male,female or unknown</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">female_words</span><span class="p">:</span>
            <span class="n">fem_w</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fem_w</span> <span class="ow">and</span> <span class="n">fem_w</span><span class="o">.</span><span class="n">lastgroup</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;female&#39;</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">male_words</span><span class="p">:</span>
            <span class="n">ma_w</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ma_w</span> <span class="ow">and</span> <span class="n">ma_w</span><span class="o">.</span><span class="n">lastgroup</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;male&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;unknown&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>Detect by image of user,it downloads the image and detect by ImageAnalyzer class.</p>
<p>Args:
    image_url (str): url of image.</p>
<p>Returns:
    [str]: male,female or unknown.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_url</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">img</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">f_name</span> <span class="o">=</span> <span class="s1">&#39;user_images/image_1.jpg&#39;</span>
        <span class="nb">open</span><span class="p">(</span><span class="n">f_name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">ia</span> <span class="o">=</span> <span class="n">ImageAnalyzer</span><span class="p">(</span><span class="n">f_name</span><span class="p">)</span>
        <span class="n">gender</span> <span class="o">=</span> <span class="n">ia</span><span class="o">.</span><span class="n">gender_identifier</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gender</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>detect by emojies used by user in bio,post&rsquo;s caption,etc.
 emojies depended to the different genders are defined in initialization.</p>
<p>Args:
    text (str): biography,post&rsquo;s caption,etc.</p>
<p>Returns:
    [dict]: dict of genders with their score. ex: {&lsquo;male&rsquo;:.2,&rsquo;female&rsquo;:.8}</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_emoji</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">counter</span> <span class="o">=</span> <span class="n">Extractor</span><span class="p">()</span><span class="o">.</span><span class="n">count_emoji</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">counter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">female_emoji</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">genders_dict</span><span class="p">[</span><span class="s1">&#39;female&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">male_emoji</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">genders_dict</span><span class="p">[</span><span class="s1">&#39;male&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">genders_dict</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>Main detect function,
this function collect all other function and append them to a dict,
each key of the dict are assigned to a function of detecting functions,
the values are also string of &lsquo;male&rsquo;,&rsquo;female&rsquo; or &lsquo;unknown&rsquo;.
there is another dict that defined in initialization,
the dict contains keys that assigned to the functions and values that are scores of each function.
in this method gets sum of all scores of males and females seperately,and gets the max of them.
the max value is the gender and score of trust of the operations.</p>
<p>Returns:
    [tuple] (str,float): first param is &lsquo;gender&rsquo; and second one in &lsquo;score of trust&rsquo;.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">detect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">is_male_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">is_female_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">gender_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_by_fullname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_full_name&#39;</span><span class="p">])</span>
        <span class="n">gender_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_by_username</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">])</span>
        <span class="n">gender_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_by_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_bio&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;user_bio&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="k">else</span> <span class="s2">&quot;unknown&quot;</span>
        <span class="n">gender_4</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_by_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_profile_pic&#39;</span><span class="p">]))</span>
        <span class="n">gender_5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_by_emoji</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_bio&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;user_bio&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genders_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;female&quot;</span><span class="p">:</span> <span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;male&quot;</span><span class="p">:</span> <span class="o">.</span><span class="mi">0</span><span class="p">}</span>

        <span class="n">gender_t</span><span class="o">=</span><span class="s2">&quot;unknown&quot;</span>
        <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;posts&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s1">&#39;caption&#39;</span> <span class="ow">in</span> <span class="n">post</span><span class="p">:</span>
                <span class="n">post</span> <span class="o">=</span> <span class="n">post</span><span class="p">[</span><span class="s1">&#39;caption&#39;</span><span class="p">]</span>
                <span class="n">gender_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_by_text</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_by_emoji</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">gender_t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s2">&quot;unknown&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">genders_dict</span><span class="p">[</span><span class="n">gender_t</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.20</span>

        <span class="k">if</span> <span class="n">gender_1</span> <span class="o">==</span> <span class="s1">&#39;male&#39;</span><span class="p">:</span>
            <span class="n">is_male_dict</span><span class="p">[</span><span class="s1">&#39;find_by_fullname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;male&#39;</span>
        <span class="k">elif</span> <span class="n">gender_1</span> <span class="o">==</span> <span class="s1">&#39;female&#39;</span><span class="p">:</span>
            <span class="n">is_female_dict</span><span class="p">[</span><span class="s1">&#39;find_by_fullname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;female&#39;</span>

        <span class="k">if</span> <span class="n">gender_2</span> <span class="o">==</span> <span class="s1">&#39;male&#39;</span><span class="p">:</span>
            <span class="n">is_male_dict</span><span class="p">[</span><span class="s1">&#39;find_by_username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;male&#39;</span>
        <span class="k">elif</span> <span class="n">gender_2</span> <span class="o">==</span> <span class="s1">&#39;female&#39;</span><span class="p">:</span>
            <span class="n">is_female_dict</span><span class="p">[</span><span class="s1">&#39;find_by_username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;female&#39;</span>

        <span class="k">if</span> <span class="n">gender_3</span> <span class="o">==</span> <span class="s1">&#39;male&#39;</span><span class="p">:</span>
            <span class="n">is_male_dict</span><span class="p">[</span><span class="s1">&#39;find_by_text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;male&#39;</span>
        <span class="k">elif</span> <span class="n">gender_3</span> <span class="o">==</span> <span class="s1">&#39;female&#39;</span><span class="p">:</span>
            <span class="n">is_female_dict</span><span class="p">[</span><span class="s1">&#39;find_by_text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;female&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;Male&#39;</span> <span class="ow">in</span> <span class="n">gender_4</span><span class="p">:</span>
            <span class="n">is_male_dict</span><span class="p">[</span><span class="s1">&#39;find_by_image&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;male&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;Female&#39;</span> <span class="ow">in</span> <span class="n">gender_4</span><span class="p">:</span>
            <span class="n">is_female_dict</span><span class="p">[</span><span class="s1">&#39;find_by_image&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;female&#39;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">gender_5</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;male&#39;</span><span class="p">:</span>
                    <span class="n">is_male_dict</span><span class="p">[</span><span class="s1">&#39;find_by_emoji&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">is_female_dict</span><span class="p">[</span><span class="s1">&#39;find_by_emoji&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
        <span class="n">male_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="p">[</span><span class="n">m_key</span><span class="p">]</span> <span class="k">for</span> <span class="n">m_key</span> <span class="ow">in</span> <span class="n">is_male_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">genders_dict</span><span class="p">[</span><span class="s1">&#39;male&#39;</span><span class="p">]])</span>
        <span class="n">female_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="p">[</span><span class="n">m_key</span><span class="p">]</span> <span class="k">for</span> <span class="n">m_key</span> <span class="ow">in</span> <span class="n">is_female_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">genders_dict</span><span class="p">[</span><span class="s1">&#39;female&#39;</span><span class="p">]])</span>
        <span class="n">male_total_weight</span> <span class="o">=</span> <span class="n">male_weight</span> <span class="o">/</span> <span class="n">is_male_dict</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_male_dict</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">female_total_weight</span> <span class="o">=</span> <span class="n">female_weight</span> <span class="o">/</span> <span class="n">is_female_dict</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_female_dict</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">male_trust_percent</span> <span class="o">=</span> <span class="n">male_total_weight</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">female_trust_percent</span> <span class="o">=</span> <span class="n">female_total_weight</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">is_male_val</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">male_trust_percent</span><span class="o">/</span><span class="p">(</span><span class="n">male_trust_percent</span><span class="o">+</span><span class="n">female_trust_percent</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">is_female_val</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">female_trust_percent</span><span class="o">/</span><span class="p">(</span><span class="n">male_trust_percent</span><span class="o">+</span><span class="n">female_trust_percent</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_male_val</span><span class="o">&gt;</span><span class="n">is_female_val</span><span class="p">:</span>
                <span class="n">final_result</span><span class="o">=</span><span class="s2">&quot;male&quot;</span>
            <span class="k">elif</span> <span class="n">is_female_val</span><span class="o">&gt;</span><span class="n">is_male_val</span><span class="p">:</span>
                <span class="n">final_result</span><span class="o">=</span><span class="s2">&quot;female&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">final_result</span><span class="o">=</span><span class="s2">&quot;unknown&quot;</span>
            
            <span class="k">return</span> <span class="s2">&quot;male&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">male_trust_percent</span><span class="p">),</span><span class="n">is_male_val</span><span class="p">,</span><span class="s2">&quot;female&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">female_trust_percent</span><span class="p">),</span>\
                    <span class="n">is_female_val</span><span class="p">,</span><span class="n">final_result</span><span class="p">,</span><span class="n">gender_1</span><span class="p">,</span><span class="n">gender_2</span><span class="p">,</span><span class="n">gender_3</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">gender_4</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">gender_5</span><span class="p">),</span><span class="n">gender_t</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span><span class="mi">0</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>if male_total_weight &gt; female_total_weight:
    return &ldquo;male&rdquo;, &ldquo;{:.2f}&rdquo;.format(male_total_weight * 100)
elif female_total_weight &gt; male_total_weight:
    return &ldquo;female&rdquo;, &ldquo;{:.2f}&rdquo;.format(female_total_weight * 100)
else:
    return &ldquo;unknown&rdquo;, 0</p>
<hr />
<p>total_weight = male_weight - female_weight
if total_weight &gt; 0:
    return &ldquo;male&rdquo;, male_weight / is_male_dict.<strong>len</strong>()
elif total_weight &lt; 0:
    return &ldquo;female&rdquo;, female_weight / is_female_dict.<strong>len</strong>()</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">text_normalizer</span><span class="p">(</span><span class="n">text</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>Normalize the text given,change the persian numbers to en
Args:
    text (str): bio,caption,etc.</p>
<p>Returns:
    [str]: normal text</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">persian_numbers</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Û°&#39;</span><span class="p">,</span> <span class="s1">&#39;Û±&#39;</span><span class="p">,</span> <span class="s1">&#39;Û²&#39;</span><span class="p">,</span> <span class="s1">&#39;Û³&#39;</span><span class="p">,</span> <span class="s1">&#39;Û´&#39;</span><span class="p">,</span> <span class="s1">&#39;Ûµ&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¶&#39;</span><span class="p">,</span> <span class="s1">&#39;Û·&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¸&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¹&#39;</span><span class="p">)</span>

    <span class="n">normal_text</span> <span class="o">=</span> <span class="n">text</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">persian_numbers</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
            <span class="n">normal_text</span> <span class="o">=</span> <span class="n">normal_text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">normal_text</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Detect age of Instagram user</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">AgeFinder</span><span class="p">(</span><span class="n">Detector</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>class initialization to predefine args and attributes.</p>
<p>Keyword Args:
    **kwargs: this must contain a dict in format and vars: user_data = {&lsquo;fullname&rsquo;:fullname ,
                    &lsquo;username&rsquo;:username ,
                    &lsquo;user_bio&rsquo;:user_bio ,
                    &lsquo;image&rsquo;: profile_pic_url,
                    &lsquo;posts&rsquo;: list of caption of the posts : [&lsquo;str&rsquo;,&rsquo;str&rsquo;,&hellip;]
                 }</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;user_data&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">education_words</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Ú©Ø§Ø±Ø´Ù†Ø§Ø³ÛŒ&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="s1">&#39;Ø§Ø±Ø´Ø¯&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Master&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="s1">&#39;Bachelor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="s1">&#39;B.A&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
            <span class="s1">&#39;M.A&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span> <span class="s1">&#39;M.s&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="s1">&#39;B.sc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="s1">&#39;Ø¯Ú©ØªØ±Ø§ÛŒ&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="s1">&#39;Ø¯Ú©ØªØ±ÛŒ&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="s2">&quot;Ø¯Ú©ØªØ±&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
            <span class="s1">&#39;Ù…Ù‡Ù†Ø¯Ø³ÛŒ&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Ù…Ù‡Ù†Ø¯Ø³&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="s2">&quot;Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒ&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span>
            <span class="s1">&#39;Ù…ØªØ®ØµØµ&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="s1">&#39;engineering&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="s1">&#39;engineer&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="s1">&#39;ph.D&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="s1">&#39;PHD&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
            <span class="s2">&quot;Chief&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">45</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">birth_words</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Ù…ØªÙˆÙ„Ø¯&#39;</span><span class="p">,</span> <span class="s1">&#39;ØªÙˆÙ„Ø¯&#39;</span><span class="p">,</span> <span class="s1">&#39;born&#39;</span><span class="p">,</span> <span class="s1">&#39;birth&#39;</span><span class="p">,</span> <span class="s1">&#39;birthday&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fa_jalali_months</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span>
            <span class="s1">&#39;ÙØ±ÙˆØ±Ø¯ÛŒÙ†&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø®Ø±Ø¯Ø§Ø¯&#39;</span><span class="p">,</span> <span class="s1">&#39;ØªÛŒØ±&#39;</span><span class="p">,</span> <span class="s1">&#39;Ù…Ø±Ø¯Ø§Ø¯&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø´Ù‡Ø±ÛŒÙˆØ±&#39;</span><span class="p">,</span> <span class="s1">&#39;Ù…Ù‡Ø±&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø¢Ø¨Ø§Ù†&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø¢Ø°Ø±&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø¯ÛŒ&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø¨Ù‡Ù…Ù†&#39;</span><span class="p">,</span> <span class="s1">&#39;Ø§Ø³ÙÙ†Ø¯&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">en_jalali_months</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span>
            <span class="s1">&#39;farvardin&#39;</span><span class="p">,</span> <span class="s1">&#39;ordibehesht&#39;</span><span class="p">,</span> <span class="s1">&#39;khordad&#39;</span><span class="p">,</span> <span class="s1">&#39;tir&#39;</span><span class="p">,</span> <span class="s1">&#39;mordad&#39;</span><span class="p">,</span> <span class="s1">&#39;shahrivar&#39;</span><span class="p">,</span> <span class="s1">&#39;mehr&#39;</span><span class="p">,</span> <span class="s1">&#39;aban&#39;</span><span class="p">,</span> <span class="s1">&#39;azar&#39;</span><span class="p">,</span> <span class="s1">&#39;dey&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bahman&#39;</span><span class="p">,</span>
            <span class="s1">&#39;esfand&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">miladi_months</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span>
            <span class="s1">&#39;january&#39;</span><span class="p">,</span> <span class="s1">&#39;february&#39;</span><span class="p">,</span> <span class="s1">&#39;march&#39;</span><span class="p">,</span> <span class="s1">&#39;april&#39;</span><span class="p">,</span> <span class="s1">&#39;may&#39;</span><span class="p">,</span> <span class="s1">&#39;june&#39;</span><span class="p">,</span> <span class="s1">&#39;july&#39;</span><span class="p">,</span> <span class="s1">&#39;august&#39;</span><span class="p">,</span> <span class="s1">&#39;september&#39;</span><span class="p">,</span> <span class="s1">&#39;october&#39;</span><span class="p">,</span>
            <span class="s1">&#39;november&#39;</span><span class="p">,</span>
            <span class="s1">&#39;december&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">miladi_months_code</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span>
            <span class="s1">&#39;jan&#39;</span><span class="p">,</span> <span class="s1">&#39;feb&#39;</span><span class="p">,</span> <span class="s1">&#39;mar&#39;</span><span class="p">,</span> <span class="s1">&#39;apr&#39;</span><span class="p">,</span> <span class="s1">&#39;may&#39;</span><span class="p">,</span> <span class="s1">&#39;jun&#39;</span><span class="p">,</span> <span class="s1">&#39;jul&#39;</span><span class="p">,</span> <span class="s1">&#39;aug&#39;</span><span class="p">,</span> <span class="s1">&#39;sep&#39;</span><span class="p">,</span> <span class="s1">&#39;sept&#39;</span><span class="p">,</span> <span class="s1">&#39;oct&#39;</span><span class="p">,</span> <span class="s1">&#39;nov&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">age_definer</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;years&#39;</span><span class="p">,</span> <span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;check_username&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">70</span><span class="p">,</span> <span class="s1">&#39;get_age_birth&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;get_age_edu&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span>
                                   <span class="s1">&#39;check_month_text&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">85</span><span class="p">,</span> <span class="s1">&#39;find_by_image&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">40</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights_posts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;check_username&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">69</span><span class="p">,</span> <span class="s1">&#39;get_age_birth&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">79</span><span class="p">,</span> <span class="s1">&#39;get_age_edu&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">74</span><span class="p">,</span>
                                         <span class="s1">&#39;check_month_text&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">84</span><span class="p">,</span> <span class="s1">&#39;find_by_image&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">39</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">persian_numbers</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Û°&#39;</span><span class="p">,</span> <span class="s1">&#39;Û±&#39;</span><span class="p">,</span> <span class="s1">&#39;Û²&#39;</span><span class="p">,</span> <span class="s1">&#39;Û³&#39;</span><span class="p">,</span> <span class="s1">&#39;Û´&#39;</span><span class="p">,</span> <span class="s1">&#39;Ûµ&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¶&#39;</span><span class="p">,</span> <span class="s1">&#39;Û·&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¸&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¹&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>Check username if contains number of years even it&rsquo;s jalali year or gregorian year type
Args:
    username (str): user&rsquo;s username</p>
<p>Returns:
    [int]: age between 13 to 90 or None</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">check_username</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">en_year</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;[1-3][09][0-9]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">en_year</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">age</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year_to_age</span><span class="p">(</span><span class="n">en_year</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">age</span> <span class="k">if</span> <span class="mi">13</span> <span class="o">&lt;=</span> <span class="n">age</span> <span class="o">&lt;</span> <span class="mi">90</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fa_year</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;[1][34][0-9]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fa_year</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">age</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year_to_age</span><span class="p">(</span><span class="n">fa_year</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">age</span> <span class="k">if</span> <span class="mi">13</span> <span class="o">&lt;=</span> <span class="n">age</span> <span class="o">&lt;</span> <span class="mi">90</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>calculating age of user</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">year_to_age</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">cal_type</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <pre><code>    Args:
</code></pre>
<p>year (int): jalali or gregorian year
   cal_type (int):  get 2 param [0,1],0 is gregorian and 1 in jalali</p>
<pre><code>    Raises:
</code></pre>
<p>AssertionError &ndash; cal_type must be 0 or 1</p>
<pre><code>    Returns:
</code></pre>
<p>[int]: age number</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span><span class="n">cal_type</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">cal_type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">age</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">age</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">age</span> <span class="o">=</span> <span class="n">jdatetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">age</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;enter a valid number[0,1]!&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>Convert jalali or gregorian date to age</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">date_to_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">cal_type</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <pre><code>    Args:
</code></pre>
<p>date (str): jalali or gregorian date
   cal_type (int):  get 2 param [0,1],0 is gregorian and 1 in jalali</p>
<pre><code>    Returns:
</code></pre>
<p>[int]: age number</p>
<p>calculating age of user,type get 2 param [0,1],0 is gregorian and 1 in jalali</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">cal_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">age</span> <span class="o">=</span> <span class="n">jdatetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="n">date</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">age</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="n">date</span>
        <span class="k">return</span> <span class="n">age</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>Find date of birth with different formats in 2 type of jalali and gregorian date in text given.</p>
<p>Args:
    text (str): biography or post&rsquo;s captions,etc.</p>
<p>Returns:
    [int]: age</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_age_birth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">text</span> <span class="o">=</span> <span class="n">text_normalizer</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">gregorian_date_regex</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-3]{0,1}[0-9]\-[0-1]{0,1}[0-9]\-[1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-3]{0,1}[0-9]\/[0-1]{0,1}[0-9]\/[1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;([1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">\-[0-1]{0,1}[0-9]\-[0-3]{0,1}[0-9])&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;([1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">\/[0-1]{0,1}[0-9]\/[0-3]{0,1}[0-9])&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">-%Y&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-1]{0,1}[0-9]\-[0-3]{0,1}[0-9]\-[1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-1]{0,1}[0-9]\/[0-3]{0,1}[0-9]\/[1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y-</span><span class="si">%d</span><span class="s1">-%m&#39;</span><span class="p">:</span> <span class="s1">&#39;([1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">\-[0-3]{0,1}[0-9]\-[0-1]{0,1}[0-9])&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y/</span><span class="si">%d</span><span class="s1">/%m&#39;</span><span class="p">:</span> <span class="s1">&#39;([1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">\/[0-3]{0,1}[0-9]\/[0-1]{0,1}[0-9])&#39;</span><span class="p">}</span>
        <span class="n">jalali_date_regex</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-3]{0,1}[0-9]\-[0-1]{0,1}[0-9]\-[1][34][0-9]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-3]{0,1}[0-9]\/[0-1]{0,1}[0-9]\/[1][34][0-9]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;([1][34][0-9]</span><span class="si">{2}</span><span class="s1">\-[0-1]{0,1}[0-9]\-[0-3]{0,1}[0-9])&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;([1][34][0-9]</span><span class="si">{2}</span><span class="s1">\/[0-1]{0,1}[0-9]\/[0-3]{0,1}[0-9])&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-9]</span><span class="si">{2}</span><span class="s1">\/[0-1]{0,1}[0-9]\/[0-3]{0,1}[0-9])&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-9]</span><span class="si">{2}</span><span class="s1">\-[0-1]{0,1}[0-9]\-[0-3]{0,1}[0-9])&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">-%Y&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-1]{0,1}[0-9]\-[0-3]{0,1}[0-9]\-[1][34][0-9]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">:</span> <span class="s1">&#39;([0-1]{0,1}[0-9]\/[0-3]{0,1}[0-9]\/[1][34][0-9]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y-</span><span class="si">%d</span><span class="s1">-%m&#39;</span><span class="p">:</span> <span class="s1">&#39;([1][34][0-9]</span><span class="si">{2}</span><span class="s1">\-[0-3]{0,1}[0-9]\-[0-1]{0,1}[0-9])&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y/</span><span class="si">%d</span><span class="s1">/%m&#39;</span><span class="p">:</span> <span class="s1">&#39;([1][34][0-9]</span><span class="si">{2}</span><span class="s1">\/[0-3]{0,1}[0-9]\/[0-1]{0,1}[0-9])&#39;</span><span class="p">,</span>
        <span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>if any(word in text for word in self.birth_words):</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="n">gregorian_date_regex</span><span class="p">:</span>
            <span class="n">birthday</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">gregorian_date_regex</span><span class="p">[</span><span class="n">rx</span><span class="p">],</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">birthday</span><span class="p">:</span>
                <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">birthday</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rx</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_to_age</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">cal_type</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="n">jalali_date_regex</span><span class="p">:</span>
            <span class="n">birthday</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">jalali_date_regex</span><span class="p">[</span><span class="n">rx</span><span class="p">],</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">birthday</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">rx</span> <span class="o">==</span> <span class="s1">&#39;%y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">birthday</span> <span class="o">=</span> <span class="s2">&quot;13&quot;</span> <span class="o">+</span> <span class="n">birthday</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span>
                <span class="k">elif</span> <span class="n">rx</span> <span class="o">==</span> <span class="s1">&#39;%y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">birthday</span> <span class="o">=</span> <span class="s2">&quot;13&quot;</span> <span class="o">+</span> <span class="n">birthday</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">birthday</span> <span class="o">=</span> <span class="n">birthday</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">birthday</span><span class="p">,</span> <span class="n">rx</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_to_age</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">cal_type</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <p>Find educational words in text.</p>
<p>Args:
    text (str): bio,caption,etc.</p>
<p>Returns:
    [tuple] (int,int): first param is &lsquo;min age&rsquo; and second is &lsquo;max age&rsquo;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_age_edu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">education_words</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">value</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <p>Check text if contains number of years even it&rsquo;s jalali year or gregorian year type
Args:
    text (str): biography or post&rsquo;s captions,etc.
    cal_type (int):  get 2 param [0,1],0 is gregorian and 1 in jalali</p>
<p>Returns:
    [int]: year</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">cal_type</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">cal_type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">g_year</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[1-3][09][0-9]</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">g_year</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">g_year</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">j_year</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[1][34][0-9]</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j_year</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">j_year</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      <p>Find day in text.</p>
<p>Args:
    text: biography or post&rsquo;s captions,etc.</p>
<p>Returns:
    [int]: day</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_day</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">day</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[1-3]{0,1}[0-9]&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">day</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-52'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-52'>#</a>
      </div>
      <p>Find month name or code in jalali and gregorian type in text given then find year in it if exists.</p>
<p>Args:
    text (str):  biography or post&rsquo;s captions,etc.
Returns:
    [int]: age or None</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">check_month_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-53'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-53'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">text</span> <span class="o">=</span> <span class="n">text_normalizer</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">miladi_months</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">miladi_months_code</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_year</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">cal_type</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-54'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-54'>#</a>
      </div>
      <p>day = self.find_day(text)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">if</span> <span class="ow">not</span> <span class="n">year</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_to_age</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">en_jalali_months</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fa_jalali_months</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_year</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">cal_type</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-55'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-55'>#</a>
      </div>
      <p>day = self.find_day(text)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">if</span> <span class="ow">not</span> <span class="n">year</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_to_age</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-56'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-56'>#</a>
      </div>
      <p>Detect by image of user,it downloads the image and detect by ImageAnalyzer class.</p>
<p>Args:
    image_url (str): url of image.</p>
<p>Returns:
    [str]: this str is contain a tuple in format (min_age,max_age).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_url</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-57'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-57'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">img</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">f_name</span> <span class="o">=</span> <span class="s1">&#39;user_images/image_1.jpg&#39;</span>
        <span class="nb">open</span><span class="p">(</span><span class="n">f_name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">ia</span> <span class="o">=</span> <span class="n">ImageAnalyzer</span><span class="p">(</span><span class="n">f_name</span><span class="p">)</span>
        <span class="n">age</span> <span class="o">=</span> <span class="n">ia</span><span class="o">.</span><span class="n">age_identifier</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">age</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-58'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-58'>#</a>
      </div>
      <p>Creates dict of detections results from caption of the posts if post_caption exists,
 else calculates the results of user&rsquo;s details.
Args:
    post_caption: caption of a post</p>
<p>Returns:
    [tuple] (dict,float): dict contains &ndash;&gt; {&lsquo;recognized_method&rsquo;:age,..},float is sum of each method score.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">_check_age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">post_caption</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-59'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-59'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">dict_recognized</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">post_caption</span><span class="p">:</span>
            <span class="n">age_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_username</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">])</span>
            <span class="n">age_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_age_birth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_bio&#39;</span><span class="p">])</span>
            <span class="n">age_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_age_edu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_bio&#39;</span><span class="p">])</span>
            <span class="n">age_4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_month_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_bio&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">age_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_username</span><span class="p">(</span><span class="n">post_caption</span><span class="p">)</span>
            <span class="n">age_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_age_birth</span><span class="p">(</span><span class="n">post_caption</span><span class="p">)</span>
            <span class="n">age_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_age_edu</span><span class="p">(</span><span class="n">post_caption</span><span class="p">)</span>
            <span class="n">age_4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_month_text</span><span class="p">(</span><span class="n">post_caption</span><span class="p">)</span>
        <span class="n">total_percent</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">age_1</span><span class="p">:</span>
            <span class="n">dict_recognized</span><span class="p">[</span><span class="s1">&#39;check_username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_1</span>
            <span class="n">total_percent</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="p">[</span><span class="s1">&#39;check_username&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">age_2</span><span class="p">:</span>
            <span class="n">dict_recognized</span><span class="p">[</span><span class="s1">&#39;get_age_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_2</span>
            <span class="n">total_percent</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="p">[</span><span class="s1">&#39;get_age_birth&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">age_3</span><span class="p">:</span>
            <span class="n">dict_recognized</span><span class="p">[</span><span class="s1">&#39;get_age_edu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_3</span>
            <span class="n">total_percent</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="p">[</span><span class="s1">&#39;get_age_edu&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">age_4</span><span class="p">:</span>
            <span class="n">dict_recognized</span><span class="p">[</span><span class="s1">&#39;check_month_text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_4</span>
            <span class="n">total_percent</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="p">[</span><span class="s1">&#39;check_month_text&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dict_recognized</span><span class="p">,</span> <span class="n">total_percent</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-60'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-60'>#</a>
      </div>
      <p>Main detect function,
This function calculates the age results of user&rsquo;s detail recognition and user&rsquo;s post captions recognition,
merge em all in a dict and sum the scores and then divide on recognized functions count to
calculate the trust percent,then collect the score of each recognized functions and collect the max of the scores
and results the age and score</p>
<p>Returns:
    [tuple] (str,float): first parameter can be age,(min_age,max_age) or unknown ,second is percent of trust.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">detect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-61'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-61'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">age_5</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_by_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_profile_pic&#39;</span><span class="p">]))</span>
        <span class="n">dict_recognized</span><span class="p">,</span> <span class="n">total_percent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_age</span><span class="p">()</span>
        <span class="n">posts_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">age_5</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">age_5</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s2">&quot;unknown&quot;</span><span class="p">:</span>
            <span class="n">dict_recognized</span><span class="p">[</span><span class="s1">&#39;find_by_image&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_5</span>
            <span class="n">total_percent</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="p">[</span><span class="s1">&#39;find_by_image&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">post</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;posts&#39;</span><span class="p">]):</span>
            <span class="n">post</span> <span class="o">=</span> <span class="n">post</span><span class="p">[</span><span class="s1">&#39;caption&#39;</span><span class="p">]</span>
            <span class="n">dict_recognized_1</span><span class="p">,</span> <span class="n">total_percent_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_age</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dict_recognized_1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">dict_recognized</span><span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">posts_keys</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights_posts</span><span class="p">[</span><span class="n">key</span><span class="p">]})</span>
                <span class="n">total_percent</span> <span class="o">+=</span> <span class="n">total_percent_2</span>
        <span class="n">avg_percent</span> <span class="o">=</span> <span class="n">total_percent</span> <span class="o">/</span> <span class="n">dict_recognized</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="k">if</span> <span class="n">dict_recognized</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">values_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_recognized</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                <span class="n">values_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__function_weights_posts</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">key</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()])])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="n">main_age</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">values_list</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">values_list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__function_weights</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">max_value</span><span class="p">:</span>
                    <span class="n">main_age</span> <span class="o">=</span> <span class="n">dict_recognized</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">main_age</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">posts_keys</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">max_value</span><span class="p">:</span>
                        <span class="n">main_age</span> <span class="o">=</span> <span class="n">dict_recognized</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">main_age</span> <span class="k">if</span> <span class="n">main_age</span> <span class="k">else</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avg_percent</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-62'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-62'>#</a>
      </div>
      <p>Detect location of Instagram users</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">LocationFinder</span><span class="p">(</span><span class="n">Detector</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-63'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-63'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-64'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-64'>#</a>
      </div>
      <p>class initialization to predefine args and attributes.</p>
<p>Keyword Args:
    **kwargs: this must contain a dict in format and vars: user_data = {&lsquo;fullname&rsquo;:fullname ,
                    &lsquo;username&rsquo;:username ,
                    &lsquo;user_bio&rsquo;:user_bio ,
                    &lsquo;image&rsquo;: profile_pic_url,
                    &lsquo;posts&rsquo;: {&lsquo;caption&rsquo;:list of caption of the posts : [&lsquo;str&rsquo;,&rsquo;str&rsquo;,&hellip;],
                              &lsquo;location&rsquo;:list of location of the posts}
                 }</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-65'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-65'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;user_data&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_bio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_bio&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phoneRegex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="sa">r</span><span class="sd">&#39;&#39;&#39;(\d{3}[-\.\s]??\d{3}[-\.\s]??\d{4}|\(\d{3}\)\s*\d{3}[-\.\s]??\d{4}|\d{3}[-\.\s]??\d{4})&#39;&#39;&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">persian_numbers</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Û°&#39;</span><span class="p">,</span> <span class="s1">&#39;Û±&#39;</span><span class="p">,</span> <span class="s1">&#39;Û²&#39;</span><span class="p">,</span> <span class="s1">&#39;Û³&#39;</span><span class="p">,</span> <span class="s1">&#39;Û´&#39;</span><span class="p">,</span> <span class="s1">&#39;Ûµ&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¶&#39;</span><span class="p">,</span> <span class="s1">&#39;Û·&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¸&#39;</span><span class="p">,</span> <span class="s1">&#39;Û¹&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;preprocess/prefix_country_phone.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country_codes</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)[</span><span class="s1">&#39;country_codes&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span> <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span> <span class="s1">&#39;district&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                                    <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_tags</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locations_list</span> <span class="o">=</span> <span class="p">[]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-66'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-66'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">language_detector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="n">lang_code</span> <span class="o">=</span> <span class="n">detect</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;preprocess/language_codes.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">iso_codes</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">iso_codes</span><span class="p">[</span><span class="s1">&#39;iso_codes&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">lang_code</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;nationality&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]}</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-67'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-67'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">country_code_detect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;preprocess/language_codes.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">iso_codes</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">iso_codes</span><span class="p">[</span><span class="s1">&#39;iso_codes&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;nationality&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]}</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-68'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-68'>#</a>
      </div>
      <p>Args:
    text (str): biography, caption of posts , etc.</p>
<p>Yields:
    [dict]: dict of partial location {&lsquo;state&rsquo;: state, &lsquo;city&rsquo;: city, &lsquo;district&rsquo;: district}</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-69'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-69'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span> <span class="ow">or</span> <span class="n">text</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text_normalizer</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">city1</span><span class="p">,</span> <span class="n">district</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;preprocess/iranstates.json&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">jsfile</span><span class="p">:</span>
            <span class="n">loc_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">jsfile</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">loc_json</span><span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">]:</span>

                <span class="k">for</span> <span class="n">city</span> <span class="ow">in</span> <span class="n">loc</span><span class="p">[</span><span class="s1">&#39;cities&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">city</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                        <span class="n">state</span> <span class="o">=</span> <span class="n">loc</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                        <span class="n">city1</span> <span class="o">=</span> <span class="n">city</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="s2">&quot;district&quot;</span> <span class="ow">in</span> <span class="n">city</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">city</span><span class="p">[</span><span class="s1">&#39;district&#39;</span><span class="p">]:</span>
                                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">dist</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                                    <span class="n">state</span> <span class="o">=</span> <span class="n">loc</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                                    <span class="n">city1</span> <span class="o">=</span> <span class="n">city</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                                    <span class="n">district</span> <span class="o">=</span> <span class="n">dist</span>
                                    <span class="k">yield</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="n">city1</span><span class="p">,</span> <span class="s2">&quot;district&quot;</span><span class="p">:</span> <span class="n">district</span><span class="p">}</span>
                                    <span class="n">state</span><span class="p">,</span> <span class="n">city1</span><span class="p">,</span> <span class="n">district</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">yield</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="n">city1</span><span class="p">,</span> <span class="s2">&quot;district&quot;</span><span class="p">:</span> <span class="n">district</span><span class="p">}</span>
                            <span class="n">state</span><span class="p">,</span> <span class="n">city1</span><span class="p">,</span> <span class="n">district</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">loc</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="n">loc</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                    <span class="k">yield</span> <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="n">city1</span><span class="p">,</span> <span class="s2">&quot;district&quot;</span><span class="p">:</span> <span class="n">district</span><span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-70'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-70'>#</a>
      </div>
      <p>print({&ldquo;state&rdquo;: state, &lsquo;city&rsquo;: city1, &ldquo;district&rdquo;: district})
if state or city1 or district:
    yield {&ldquo;state&rdquo;: state, &lsquo;city&rsquo;: city1, &ldquo;district&rdquo;: district}
    print(44444444444444444444)
return</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-71'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-71'>#</a>
      </div>
      <p>a = geograpy.get_place_context(text=text)
a = geograpy.Extractor(text=text)
print(a.find_entities())
a=geograpy.Extractor(text=text)
a.find_entities()
places = GeoText(text)
return a</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-72'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-72'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_by_phone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="n">location</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">phones</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phoneRegex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">text_normalizer</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">phone</span> <span class="ow">in</span> <span class="n">phones</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_codes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">phone</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">location</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">})</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-73'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-73'>#</a>
      </div>
      <p>Create dictionary of locations and repeatation number of them</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__places_dict_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_generator</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-74'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-74'>#</a>
      </div>
      <p>Args:
    obj_generator (Generator): Generator that contains a dict({&ldquo;state&rdquo;: state, &lsquo;city&rsquo;: city, &ldquo;district&rdquo;: district})</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">obj_generator</span><span class="p">:</span>
            <span class="n">obj_place_counter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ob_dict</span> <span class="o">=</span> <span class="n">obj_generator</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">locations_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_dict</span><span class="p">)</span>
                    <span class="n">obj_place_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">ob_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                            <span class="n">b_counter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">value</span><span class="p">]</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span><span class="p">[</span>
                                <span class="n">key</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">value</span><span class="p">:</span> <span class="n">b_counter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">})</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="k">break</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-75'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-75'>#</a>
      </div>
      <p>Finds the locations in bio or posts caption,geo tags in posts and if geo tags exists add them to</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">_generate_place</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-76'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-76'>#</a>
      </div>
      <p>the final dict and count them.</p>
<p>Returns:
    locations_dict[dict]: returns dict of locations and states in type of: 
    {&lsquo;country&rsquo;: {&ldquo;country&rdquo;:count_of_repeatation}, &lsquo;state&rsquo;: {&ldquo;state&rdquo;:count_of_repeatation},
    &lsquo;city&rsquo;: {&ldquo;city&rdquo;:count_of_repeatation},&rsquo;district&rsquo;: {&ldquo;district&rdquo;:&rdquo;count_of_repeatation&rdquo;},
    &lsquo;location&rsquo;: {&ldquo;location&rdquo;:count_of_repeatation}}</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">bio_places_generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_by_place</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_bio</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bio_places_generator</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__places_dict_maker</span><span class="p">(</span><span class="n">bio_places_generator</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;caption&#39;</span> <span class="ow">in</span> <span class="n">post</span><span class="p">:</span>
                <span class="n">post_places_generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_by_place</span><span class="p">(</span><span class="n">post</span><span class="p">[</span><span class="s1">&#39;caption&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">post_places_generator</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__places_dict_maker</span><span class="p">(</span><span class="n">post_places_generator</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;location&#39;</span> <span class="ow">in</span> <span class="n">post</span> <span class="ow">and</span> <span class="n">post</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">post</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">geo_tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">post</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">geo_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_tags</span><span class="p">:</span>
            <span class="n">geo</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">geo_tag</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">geo</span><span class="p">:</span>
                <span class="n">geo_name</span> <span class="o">=</span> <span class="n">geo</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">b_counter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">][</span><span class="n">geo_name</span><span class="p">]</span> <span class="k">if</span> <span class="n">geo_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span><span class="p">[</span>
                    <span class="s1">&#39;location&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">geo_name</span><span class="p">:</span> <span class="n">b_counter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">})</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-77'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-77'>#</a>
      </div>
      <p>mys = set()
for item in self.locations_list:
    mys.add(tuple(item.items()))
print(mys)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations_list_dict</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-78'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-78'>#</a>
      </div>
      <p>Final detection of locations</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">detect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-79'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-79'>#</a>
      </div>
      <p>Returns:
    [tuple]: (dict of locations and states in type of: 
    {&lsquo;country&rsquo;: {&ldquo;country&rdquo;:count_of_repeatation}, &lsquo;state&rsquo;: {&ldquo;state&rdquo;:count_of_repeatation},
    &lsquo;city&rsquo;: {&ldquo;city&rdquo;:count_of_repeatation},&rsquo;district&rsquo;: {&ldquo;district&rdquo;:&rdquo;count_of_repeatation&rdquo;},
    &lsquo;location&rsquo;: {&ldquo;location&rdquo;:count_of_repeatation}}, None(to be in format of tuple))</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_generate_place</span><span class="p">()),</span><span class="kc">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-80'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-80'>#</a>
      </div>
      <p>Decorator to itter posts of a user,concat the likes and comments counts</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">posts_iterator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-81'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-81'>#</a>
      </div>
      <p>Args:
    func ([function]): call the function that using post iteration.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">likes_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">comments_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts</span><span class="p">:</span>
                <span class="n">likes_count</span> <span class="o">+=</span> <span class="n">post</span><span class="p">[</span><span class="s1">&#39;like_count&#39;</span><span class="p">]</span>
                <span class="n">comments_count</span> <span class="o">+=</span> <span class="n">post</span><span class="p">[</span><span class="s1">&#39;comments_count&#39;</span><span class="p">]</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tot_likes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">likes_count</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tot_comments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comments_count</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-82'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-82'>#</a>
      </div>
      <p>Detect users audience type</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">AudienceTypeFinder</span><span class="p">(</span><span class="n">Detector</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-83'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-83'>#</a>
      </div>
      <p>class initialization to predefine args and attributes.</p>
<p>Keyword Args:
    **kwargs: this must contain a dict in format and vars: user_data = 
                { <br />
                    &lsquo;fullname&rsquo;:fullname ,
                    &lsquo;user_is_verified&rsquo;:user_is_verified,
                    &lsquo;user_followers&rsquo;:user_followers,
                    &lsquo;user_following&rsquo;:user_following,
                    &lsquo;user_is_private&rsquo;:user_is_private,
                    &lsquo;highlight_reel_count&rsquo;:highlight_reel_count
                    &lsquo;username&rsquo;:username ,
                    &lsquo;user_bio&rsquo;:user_bio ,
                    &ldquo;date&rdquo;:date,
                    &lsquo;image&rsquo;: profile_pic_url,
                    &lsquo;posts&rsquo;: list of dictionaries for posts : [{&ldquo;like_count&rdquo;:int(),&rdquo;comments_count&rdquo;:int()}]
                 }</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-84'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-84'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;user_data&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_followers&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">followings_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_following&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_bio&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">posts_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_posts&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_verified</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_is_verified&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_private</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_is_private&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profile_picture</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_profile_pic&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_full_name&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">posts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;posts&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlight_reel_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;highlight_reel_count&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__real_users_ratio</span> <span class="o">=</span> <span class="p">{</span><span class="mi">500000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">11.06</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">4.26</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">6.8</span><span class="p">,</span>
                                            <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">15.32</span><span class="p">},</span>
                                   <span class="mi">3000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">10.7</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">1.01</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">7.1</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">3.6</span><span class="p">,</span>
                                          <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">17.8</span><span class="p">},</span>
                                   <span class="mi">2000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">12.63</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">1.68</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">8.38</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">4.25</span><span class="p">,</span>
                                          <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">21.01</span><span class="p">},</span>
                                   <span class="mi">8000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">5.62</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.26</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">3.57</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">2.05</span><span class="p">,</span>
                                          <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">9.19</span><span class="p">},</span>
                                   <span class="mi">100</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">35.09</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">2.83</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">24.59</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">10.5</span><span class="p">,</span>
                                         <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">59.68</span><span class="p">},</span>
                                   <span class="mi">50000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">9.35</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.42</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">6.33</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">3.02</span><span class="p">,</span>
                                           <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">15.68</span><span class="p">},</span>
                                   <span class="mi">300000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">11.48</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">7.64</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">3.84</span><span class="p">,</span>
                                            <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">19.12</span><span class="p">},</span>
                                   <span class="mi">10000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">7.08</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.63</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">3.68</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">3.4</span><span class="p">,</span>
                                           <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">10.76</span><span class="p">},</span>
                                   <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">24.98</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">1.85</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">9.83</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">15.15</span><span class="p">,</span>
                                       <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">34.81</span><span class="p">},</span>
                                   <span class="mi">100000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">9.85</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.43</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">4.79</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">5.06</span><span class="p">,</span>
                                            <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">14.64</span><span class="p">},</span>
                                   <span class="mi">1000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">12.47</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.84</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">6.6</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">5.87</span><span class="p">,</span>
                                          <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">19.07</span><span class="p">},</span>
                                   <span class="mi">80000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">16.43</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">1.32</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">11.06</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">5.37</span><span class="p">,</span>
                                           <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">27.49</span><span class="p">},</span>
                                   <span class="mi">5000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">9.91</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.38</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">5.99</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">3.92</span><span class="p">,</span>
                                          <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">15.9</span><span class="p">},</span>
                                   <span class="mi">1000000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">6.23</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">4.56</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">1.67</span><span class="p">,</span>
                                             <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">10.79</span><span class="p">},</span>
                                   <span class="mi">500</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">19.62</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">1.43</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">11.01</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">8.61</span><span class="p">,</span>
                                         <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">30.63</span><span class="p">},</span>
                                   <span class="mi">20000</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;like&#39;</span><span class="p">:</span> <span class="mf">6.44</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span> <span class="s1">&#39;standard_dev&#39;</span><span class="p">:</span> <span class="mf">4.93</span><span class="p">,</span> <span class="s1">&#39;first_quarter&#39;</span><span class="p">:</span> <span class="mf">1.51</span><span class="p">,</span>
                                           <span class="s1">&#39;third_quarter&#39;</span><span class="p">:</span> <span class="mf">11.37</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fl_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_fl_status</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-85'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-85'>#</a>
      </div>
      <p>Counts the username&rsquo;s digits</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__count_username_digits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-86'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-86'>#</a>
      </div>
      <p>Returns:
    [int]: count of digits in username</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">counter</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-87'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-87'>#</a>
      </div>
      <p>Counts username&rsquo;s alphabets</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__count_username_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-88'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-88'>#</a>
      </div>
      <p>Returns:
    [int]: count of username&rsquo;s alphabets</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">counter</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-89'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-89'>#</a>
      </div>
      <p>Calculates username&rsquo;s ratio of number of digits to username&rsquo;s alphabets.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__cal_username_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-90'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-90'>#</a>
      </div>
      <p>Returns:
    [bool]:  if result is more than 60 percent returns True,else False</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__count_username_digits</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_name</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">60</span> <span class="k">else</span> <span class="kc">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-91'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-91'>#</a>
      </div>
      <p>Check if user is real by looking for the distance of following/followers counts,private accounts,fullname,</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_real_people</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-92'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-92'>#</a>
      </div>
      <p>profile picture,verified users,bio,highlighted stories,posts count.
assigned an score to every parameter.</p>
<p>Returns:
    [float]: returns total score of parameters</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">total_score</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">followings_count</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span> <span class="o">&lt;</span> <span class="mi">3000</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="mf">0.30</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_private</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">10</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">10</span>
        <span class="k">if</span> <span class="s2">&quot;YW5vbnltb3VzX3Byb2ZpbGVfcGlj.2&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile_picture</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">10</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_verified</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bio</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">10</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlight_reel_count</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlight_reel_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">20</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-93'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-93'>#</a>
      </div>
      <p>if self.__cal_username_ratio():
    total_score -= .30</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">total_score</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts_count</span> <span class="o">*</span> <span class="mf">0.10</span>

        <span class="k">return</span> <span class="n">total_score</span> <span class="k">if</span> <span class="n">total_score</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-94'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-94'>#</a>
      </div>
      <p>Find if user is fake by calculating distance of following/follower parameters</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_fake_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-95'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-95'>#</a>
      </div>
      <p>Returns:
    [int]: 1 if fake else 0</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">followings_count</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3500</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fl_status</span> <span class="o">==</span> <span class="s1">&#39;bad&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="mi">0</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-96'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-96'>#</a>
      </div>
      <p>Find if user has mass follower by checking following and followers</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_mass_follower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-97'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-97'>#</a>
      </div>
      <p>Returns:
    [int]: 1 if has mass follower else 0</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">followings_count</span> <span class="o">&gt;</span> <span class="mi">1500</span> <span class="ow">and</span> <span class="mi">10000</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span> <span class="o">&gt;</span> <span class="mi">5000</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_fake_follower</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="mi">0</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-98'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-98'>#</a>
      </div>
      <p>Find if user is bot by checking followers count,posts count, username ratio and profile picture.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_bot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-99'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-99'>#</a>
      </div>
      <p>Returns:
    [float]: score of bot user</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">total_score</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">50</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">20</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cal_username_ratio</span><span class="p">():</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">20</span>
        <span class="k">if</span> <span class="s2">&quot;YW5vbnltb3VzX3Byb2ZpbGVfcGlj.2&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile_picture</span><span class="p">:</span>
            <span class="n">total_score</span> <span class="o">+=</span> <span class="o">.</span><span class="mi">10</span>
        <span class="k">return</span> <span class="n">total_score</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-100'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-100'>#</a>
      </div>
      <p>Find if account is stolen or deactivated by checking last post datetime</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_stolen_account</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-101'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-101'>#</a>
      </div>
      <p>Returns:
    [bool]: True if is stolen else False</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts</span><span class="p">:</span>
            <span class="n">last_post_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">posts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%SZ&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_post_time</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="o">&gt;</span> <span class="mi">365</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-102'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-102'>#</a>
      </div>
      <p>Calculates ratio of posts likes to follower</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nd">@posts_iterator</span>
    <span class="k">def</span> <span class="nf">_calculate_lf_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-103'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-103'>#</a>
      </div>
      <p>Returns:
    [float]: returns ratio or None for division by zero</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tot_likes&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-104'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-104'>#</a>
      </div>
      <p>Check if user is influencer by looking for more than 10000 followers counts.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_influencer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-105'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-105'>#</a>
      </div>
      <p>Returns:
    [int]: 1 for True and 0 for False</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="mi">0</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-106'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-106'>#</a>
      </div>
      <p>find status of posts like to follower situation depended to real users ratio</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">find_fl_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-107'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-107'>#</a>
      </div>
      <p>Returns:
    [string]: unknown,bad,normal,good,excellent</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_private</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__real_users_ratio</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="fm">__reversed__</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span> <span class="o">&gt;</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">user_engagement_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_lf_ratio</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">user_engagement_ratio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span>
                <span class="n">first_quarter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__real_users_ratio</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;first_quarter&#39;</span><span class="p">]</span>
                <span class="n">third_quarter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__real_users_ratio</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;third_quarter&#39;</span><span class="p">]</span>
                <span class="n">norm_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__real_users_ratio</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;like&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">user_engagement_ratio</span> <span class="o">&lt;</span> <span class="n">first_quarter</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;bad&#39;</span>
                <span class="k">elif</span> <span class="n">first_quarter</span> <span class="o">&lt;</span> <span class="n">user_engagement_ratio</span> <span class="o">&lt;=</span> <span class="n">norm_avg</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;normal&#39;</span>
                <span class="k">elif</span> <span class="n">norm_avg</span> <span class="o">&lt;</span> <span class="n">user_engagement_ratio</span> <span class="o">&lt;</span> <span class="n">third_quarter</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;good&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;excellent&#39;</span>
        <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-108'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-108'>#</a>
      </div>
      <p>calculate total engagement of latest 12 posts of user</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nd">@posts_iterator</span>
    <span class="k">def</span> <span class="nf">calculate_engagement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-109'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-109'>#</a>
      </div>
      <p>Returns:
    [float]: ratio of total likes count + total comments to posts count,or None for division by zero.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">((((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tot_likes&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s1">&#39;tot_comments&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">followers_count</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="fm">__len__</span><span class="p">())</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-110'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-110'>#</a>
      </div>
      <p>Categories and generates final results into suspicious,influencer and real accounts,</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">detect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-111'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-111'>#</a>
      </div>
      <p>by checking methods points and results</p>
<p>Returns:
    [tuple]: (type,engagement status,engagement ratio)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">engagement_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_engagement</span><span class="p">()</span>
        <span class="n">engagement_ratio</span> <span class="o">=</span> <span class="n">engagement_ratio</span> <span class="k">if</span> <span class="n">engagement_ratio</span> <span class="k">else</span> <span class="s2">&quot;unknown&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">engagement_ratio</span><span class="p">)</span>
        <span class="n">final_res</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;is_real&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;is_fake&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_fake_user</span><span class="p">(),</span> <span class="s1">&#39;is_bot&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_bot</span><span class="p">(),</span> <span class="s1">&#39;stolen&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                     <span class="s1">&#39;influencer&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_influencer</span><span class="p">(),</span> <span class="s1">&#39;engagement_status&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fl_status</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">final_res</span><span class="p">[</span><span class="s1">&#39;is_bot&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">50</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;suspicious&#39;</span><span class="p">,</span> <span class="s1">&#39;is_bot&#39;</span><span class="p">,</span> <span class="n">engagement_ratio</span>
        <span class="k">if</span> <span class="n">final_res</span><span class="p">[</span><span class="s1">&#39;is_fake&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s1">&#39;suspicious&#39;</span><span class="p">,</span> <span class="s1">&#39;is_fake&#39;</span><span class="p">,</span> <span class="n">engagement_ratio</span>

        <span class="n">is_real</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_real_people</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_real</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">50</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_stolen_account</span><span class="p">():</span>
                <span class="k">return</span> <span class="s1">&#39;suspicious&#39;</span><span class="p">,</span> <span class="s1">&#39;stolen&#39;</span><span class="p">,</span> <span class="n">engagement_ratio</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_influencer</span><span class="p">():</span>
                <span class="k">return</span> <span class="s1">&#39;influencer&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fl_status</span><span class="p">,</span> <span class="n">engagement_ratio</span>
            <span class="k">return</span> <span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fl_status</span><span class="p">,</span> <span class="n">engagement_ratio</span>
        <span class="k">return</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="n">is_real</span><span class="p">,</span> <span class="n">engagement_ratio</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-112'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-112'>#</a>
      </div>
      <p>is_influencer = None
if is_influencer == 1:
    final_res[&lsquo;influencer&rsquo;] = 1
elif is_influencer == 0:
    final_res[&lsquo;influencer&rsquo;] = 0
else:
    final_res[&lsquo;has_fake_follower&rsquo;] = 1
    if self.is_verified:
        final_res[&lsquo;influencer&rsquo;] = 0
final_res[&lsquo;is_bot&rsquo;] = self.find_bot()
is_real = self.find_real_people()
final_res[&lsquo;is_real&rsquo;] = is_real
if is_real &gt; .50:
    final_res[&lsquo;stolen&rsquo;] = self.find_stolen_account()</p>
<p>if self.has_fake_follower:
    final_res[&lsquo;has_fake_follower&rsquo;] = 1
else:
    final_res[&lsquo;has_fake_follower&rsquo;] = 0
if self.find_fake_user():
    final_res[&lsquo;is_fake&rsquo;] = 1
print(final_res)</p>
<p>max_res = max(final_res.values())
print(final_res)
for key, value in final_res.items():
    if max_res == value:
        return key, value * 100</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-113'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-113'>#</a>
      </div>
      <p>is_real = self.find_real_people()
print(is_real)
if is_real &gt;= .50:
    final_res.update({&lsquo;is_real&rsquo;: True})
    # return &lsquo;is_real&rsquo;, is_real
if self.find_fake_user():
    final_res.update({&lsquo;is_fake&rsquo;: True})</p>
<pre><code># return 'is_fake', 1
</code></pre>
<p>if self.find_bot():
    final_res.update({&lsquo;is_bot&rsquo;: True})</p>
<pre><code># return 'is_bot', 1
</code></pre>
<p>if self.find_mass_follower():
    final_res.update({&lsquo;mass_follower&rsquo;: True})</p>
<pre><code># return 'mass_follower', 1
</code></pre>
<p>if self.find_stolen_account():
    final_res.update({&lsquo;stolen&rsquo;: True})</p>
<pre><code># return 'stolen', 1
</code></pre>
<p>if self.find_influencer():
    final_res.update({&lsquo;influencer&rsquo;: True})</p>
<pre><code># return 'influencer', 1
</code></pre>
<p>print(final_res)
return 1, 2</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">au</span> <span class="o">=</span> <span class="n">AudienceTypeFinder</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-114'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-114'>#</a>
      </div>
      <p>au.calculate_engagement()
au.find_engagment_status()</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
